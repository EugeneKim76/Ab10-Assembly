library(karyoploteR)
library(data.table)
library(ggplot2)

setwd("~/karyoploter/data")

Ab10.Kindr <- read.table('Kindr.modified.bed')
Ab10.Kindr.chr10.range <- toGRanges(Ab10.Kindr.chr10)
Ab10.paf <- toGRanges(read.table('Ab10_strand_end.bed'))
N10.paf <- toGRanges(read.table('N10_end.bed'))
Ab10.1.paf <- toGRanges(read.table('Ab10_strand_end_link1.bed'))
N10.1.paf <- toGRanges(read.table('N10_end_link1.bed'))
Ab10.2.paf <- toGRanges(read.table('Ab10_strand_end_link2.bed'))
N10.2.paf <- toGRanges(read.table('N10_end_link2.bed'))
Ab10.3.paf <- toGRanges(read.table('Ab10_strand_end_link3.bed'))
N10.3.paf <- toGRanges(read.table('N10_end_link3.bed'))

tiff("Ab10_N10.tif", width = 10, height = 2, units = 'in', res = 900)
N10_Ab10 <- plotKaryotype(genome = Ab10_N10.genome,cytobands = Ab10_N10.cytobands, plot.type=2, plot.params = pp)
#kpAddBaseNumbers(N10_Ab10, tick.dist = 1000000, add.units = FALSE,minor.tick.len=0)
kpPlotLinks(N10_Ab10, data=N10.1.paf, data2=Ab10.1.paf,col="#a79b8e",lwd=0.1)
kpPlotLinks(N10_Ab10, data=N10.2.paf, data2=Ab10.2.paf,col="#5D6A7C",lwd=0.1,arch.height=0.3)
kpPlotLinks(N10_Ab10, data=N10.3.paf, data2=Ab10.3.paf,col="#ccb9ca",lwd=0.1,arch.height=0.3)
kpRect(N10_Ab10, data=toGRanges(Ab10.kno180.chr10),x0=Ab10.kno180.chr10$V2,x1=Ab10.kno180.chr10$V3,y0=0, y1=1,lwd=0.00,r0=-0.3, r1=-0.01,col='#0000CD',border=NA)
kpRect(N10_Ab10, data=toGRanges(Ab10.TR1.chr10),x0=Ab10.TR1.chr10$V2,x1=Ab10.TR1.chr10$V3,y0=0, y1=1,lwd=0.00,r0=-0.3, r1=-0.01,col='#B22222',border=NA)
kpRect(N10_Ab10, data=toGRanges(Ab10.Kindr),x0=Ab10.Kindr$V2,x1=Ab10.Kindr$V3,y0=0, y1=1,lwd=0.04,r0=-0.3, r1=-0.01,col='black',border='black')
kpHeatmap(N10_Ab10, Ab10.Gypsy.10kb.chr10.range, y=Ab10.Gypsy.10kb.chr10$V4, colors = c(transparent('#FFFFFF', amount=0),'#556272','#3b444f','#22272d'), r0=-0.6, r1=-0.3)
kpHeatmap(N10_Ab10, Ab10.cinful_zeon.10kb.chr10.range, y=Ab10.cinful_zeon.10kb.chr10$V4, colors = c(transparent('#FFFFFF', amount=0),'#401b89','#2e1362','#1b0b3b'), r0=-0.9, r1=-0.6)
kpHeatmap(N10_Ab10, Ab10.gene.10kb.chr10.range, y=Ab10.gene.10kb.chr10$V4, colors = c(transparent('#FFFFFF', amount=0),'#206e78','#19565d','#154950','#123d43'), r0=-1.2, r1=-0.9)
dev.off()
